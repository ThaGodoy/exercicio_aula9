{"name":"Exercicio aula9","tagline":"","body":"**Aluna: Thaís Fernanda Godoy**\r\n\r\n##**EXERCÍCIO AULA 9**\r\n\r\n2) Faça mapeamento de QTL’s no conjunto de dados Mouse Data usando a aproximação de Haley-Knott.\r\n•\tUse probabilidades de dois pontos para fazer inferências sobre eventual QTL no intervalo entre dois marcadores (usando a “famosa” tabela discutida durante a aula).\r\n•\tLembre-se que em situações reais o ideal seria usar probabilidades multiponto; tal estratégia não será usada no exercício apenas por razões didáticas. Use somente adaptações de códigos em R usados em listas anteriores e apresentados em aula (função lm(), etc), ou seja, não use o R/qtl ou programa similar para fazer as análises, mas sim funções do R desenvolvidas para realizar regressões lineares.\r\n•\tSe preferir, use alguma planilha eletrônica para calcular as probabilidades condicionais. Apresente o resultado em um gráfico, e também uma tabela com o(s) valor(es) do(s) QTL(s) mapeado(s), de forma semelhante ao apresentado na literatura (efeitos, LOD, etc).\r\n•\tAssuma que o threshold é 1.43 (LOD). O objetivo do exercício é entender os fundamentos estatísticos e de programação envolvidos, e não os resultados em si.\r\n•\tO exercício pode ser feito pelo mesmo grupo que analisou os dados de Mimulus.\r\n\r\nOs comandos utilizados foram os seguintes:\r\n\r\n```javascript\r\nrm(list = ls(all = TRUE))\r\nmouse <- read.csv(\"E:/ESALQ/POS_GRADUACAO_ESALQ_USP/DOUTORADO_2014/disciplinas/Biometria de Marcadores Gen/Aula 2/augusto-garcia-R-Introduction-7224f6a/mouse.csv\")\r\nmouse2<-mouse[2:16]\r\nmap<-c(0, 6.8, 1.0, 1.0, 2.9, 2.9, 4.9, 3.9, 1.0, 1.9, 1.9, 2.9, 6.8, 10.8)\r\nmap<-cumsum(map)\r\nmap\r\nk_mf<-function(m)\r\n  0.5 * tanh(m/50)\r\nret.pred<-function(x, y, theta){\r\n  if(x==1 & y==1) return(1)\r\n  else if(x==1 & y==0) return(1-theta)\r\n  else if(x==0 & y==1) return(theta)\r\n  else if(x==0 & y==0) return(0)\r\n  else stop\r\n}\r\ninterv<-diff(map)\r\nres<-numeric()\r\nfor(k in 2:(ncol(mouse2)-1)){\r\n  m<-seq(from=0, to=interv[k-1], by=1)\r\n  theta<-k_mf(m)/k_mf(interv[1])\r\n  temp.all<-numeric()\r\n  for(j in 1:nrow(mouse2)){\r\n    temp<-numeric(length(theta))\r\n    for(i in 1:length(theta)){\r\n      temp[i]<-ret.pred(x=mouse2[j,k], y=mouse2[j,k+1],theta[i])\r\n    }\r\n    temp.all<-rbind(temp.all, temp)\r\n  }\r\n  res<-cbind(res, temp.all)\r\n}\r\nF<-numeric(ncol(res))\r\nR2<- numeric(ncol(res))\r\nefect<- numeric(ncol(res))\r\nfor(i in 1:ncol(res)){\r\n  model<-summary(lm(mouse2[,1] ~ res[,i]))\r\n  print (model)\r\n  F[i-1]<-(round((model$fstatistic[1]),2))\r\n  R2[i-1]<- (round((model$r.squared),2))\r\n  efect[i-1]<- (round((model$coefficients[2,1]),2))\r\n}\r\nF\r\nLOD <- (round(((103/2)*(log10((F*1/101)+1))),2))\r\nLOD\r\nR2*100\r\nefect\r\nplot(LOD, type=\"l\", ylab=\"LOD score\", xlab=\"Localização (cM)\", ylim=c(0,8),\r\n     xlim=c(0,50), lwd=3)\r\nabline(h=1.43, col=\"blue\", lty=3, lwd=3)\r\nfinal<-data.frame(LOD,R2,efect)\r\nfinal\r\n```\r\n\r\nResultados\r\n\r\n```javascript\r\n> final\r\n    LOD   R2 efect\r\n1  3.31 0.14  7.41\r\n2  3.69 0.15  7.88\r\n3  4.04 0.17  8.26\r\n4  4.36 0.18  8.54\r\n5  4.62 0.19  8.70\r\n6  4.82 0.19  8.75\r\n7  4.94 0.20  8.71\r\n8  5.02 0.20  8.79\r\n9  5.36 0.21  9.00\r\n10 5.46 0.22  9.10\r\n11 5.80 0.23  9.35\r\n12 5.79 0.23  9.41\r\n13 5.75 0.23  9.42\r\n14 5.10 0.20  8.80\r\n15 5.31 0.21  9.02\r\n16 5.49 0.22  9.20\r\n17 5.93 0.23  9.38\r\n18 5.98 0.23  9.53\r\n19 5.96 0.23  9.60\r\n20 5.89 0.23  9.58\r\n21 5.76 0.23  9.47\r\n22 5.13 0.20  8.78\r\n23 5.33 0.21  9.00\r\n24 5.50 0.22  9.18\r\n25 5.63 0.22  9.29\r\n26 5.73 0.23  9.15\r\n27 5.70 0.23  9.16\r\n28 5.34 0.21  8.87\r\n29 5.42 0.22  8.97\r\n30 5.50 0.22  8.98\r\n31 5.55 0.22  9.06\r\n32 5.39 0.21  8.90\r\n33 5.22 0.21  8.84\r\n34 5.02 0.20  8.73\r\n35 3.81 0.16  7.61\r\n36 3.94 0.16  7.86\r\n37 4.02 0.16  8.03\r\n38 4.05 0.17  8.11\r\n39 4.03 0.16  8.09\r\n40 3.95 0.16  7.97\r\n41 3.83 0.16  7.76\r\n42 3.71 0.15  7.54\r\n43 3.62 0.15  7.66\r\n44 3.46 0.14  7.63\r\n45 3.23 0.13  7.46\r\n46 2.94 0.12  7.13\r\n47 2.62 0.11  6.68\r\n48 2.28 0.10  6.13\r\n49 1.95 0.08  5.53\r\n50 1.64 0.07  4.91\r\n51 1.36 0.06  4.32\r\n52 1.11 0.05  3.75\r\n53 0.00 0.00  0.00\r\n```\r\n\r\n![Gráfico LOD](https://cloud.githubusercontent.com/assets/12297507/8116095/693d5d04-1056-11e5-88e3-54d162f7e49b.jpeg)\r\n\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}